<div id="help-section" class="section" style="display: none; min-height: 100vh">
  <div class="container py-4">
    <div class="mb-4">
      <h1 class="display-6 mb-2">
        <i class="bi bi-question-circle-fill text-primary me-2"></i>Help &amp;
        Documentation
      </h1>
      <div class="alert alert-info d-flex align-items-center" role="alert">
        <i class="bi bi-info-circle-fill me-2"></i>
        Welcome to the Globe SCSOT Help Center! This guide contains detailed
        information on using all features of the Submarine Cable System Outage
        Tracker.
      </div>
    </div>
    <div class="accordion" id="helpAccordion">
      <!-- Overview -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingOverview">
          <button
            class="accordion-button"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#collapseOverview"
            aria-expanded="true"
            aria-controls="collapseOverview"
          >
            <span id="help-overview"></span>
            <i class="bi bi-info-circle me-2 text-primary"></i>1. System
            Overview
          </button>
        </h2>
        <div
          id="collapseOverview"
          class="accordion-collapse collapse show"
          aria-labelledby="headingOverview"
          data-bs-parent="#helpAccordion"
        >
          <div class="accordion-body">
            <div class="card card-body bg-light help-card mb-3">
              <h5>
                <i class="bi bi-layout-text-window me-2"></i>About the ISCS
                Dashboard
              </h5>
              <p>
                The Globe ISCS (International Submarine Cable System) Dashboard
                is a comprehensive monitoring and management tool designed to
                track submarine cable system availability, outages, and
                incidents. This application provides real-time data
                visualization, incident tracking, and historical analysis tools
                to help you maintain optimal network operations.
              </p>
            </div>

            <div class="row g-3">
              <div class="col-md-6">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <h5 class="card-title">
                      <i class="bi bi-stack me-2"></i>Key Features
                    </h5>
                    <ul>
                      <li>
                        <strong>Dashboard Overview</strong> - Consolidated view
                        of critical metrics
                      </li>
                      <li>
                        <strong>Network Availability</strong> - Monthly
                        availability metrics by cable system
                      </li>
                      <li>
                        <strong>Outage Summary</strong> - Aggregated view of
                        outages by reason
                      </li>
                      <li>
                        <strong>Incident Management</strong> - Complete CRUD
                        operations for incidents
                      </li>
                      <li>
                        <strong>Google Sheets Integration</strong> - Connect to
                        your own data source
                      </li>
                      <li>
                        <strong>Dark Mode Support</strong> - Reduced eye strain
                        for extended use
                      </li>
                    </ul>
                  </div>
                </div>
              </div>

              <div class="col-md-6">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <h5 class="card-title">
                      <i class="bi bi-signpost-split me-2"></i>Navigation Guide
                    </h5>
                    <p>
                      The application is organized into several key sections:
                    </p>
                    <ul>
                      <li>
                        <strong>Dashboard</strong> - Main view with all key
                        components
                      </li>
                      <li>
                        <strong>Settings</strong> - Configure your data source
                      </li>
                      <li>
                        <strong>Help</strong> - This comprehensive documentation
                      </li>
                    </ul>
                    <p>
                      Use the sidebar navigation to switch between sections
                      instantly.
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Dashboard Features -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingDashboard">
          <button
            class="accordion-button collapsed"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#collapseDashboard"
            aria-expanded="false"
            aria-controls="collapseDashboard"
          >
            <span id="help-dashboard"></span>
            <i class="bi bi-speedometer2 me-2 text-success"></i>2. Dashboard
            Features
          </button>
        </h2>
        <div
          id="collapseDashboard"
          class="accordion-collapse collapse"
          aria-labelledby="headingDashboard"
          data-bs-parent="#helpAccordion"
        >
          <div class="accordion-body">
            <div class="card card-body bg-light help-card mb-3">
              <h5><i class="bi bi-grid-1x2 me-2"></i>Dashboard Layout</h5>
              <p>
                The dashboard is designed with a modular layout that provides
                immediate access to all critical information. Each component can
                be interacted with independently while maintaining a cohesive
                view of your submarine cable systems.
              </p>
            </div>

            <div class="row g-3 mb-3">
              <div class="col-md-6">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <h5 class="card-title">
                      <i class="bi bi-layout-three-columns me-2"></i>Component
                      Organization
                    </h5>
                    <p>The dashboard is divided into three main sections:</p>
                    <ol>
                      <li>
                        <strong>Outage Summary</strong> - Top left panel showing
                        aggregated outage data
                      </li>
                      <li>
                        <strong>Major Incidents</strong> - Top right panel
                        listing all incident tickets
                      </li>
                      <li>
                        <strong>Network Availability</strong> - Bottom panel
                        showing monthly availability metrics
                      </li>
                    </ol>
                    <p>
                      Each section includes its own toolbar with search,
                      filtering, and pagination controls.
                    </p>
                  </div>
                </div>
              </div>

              <div class="col-md-6">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <h5 class="card-title">
                      <i class="bi bi-arrow-repeat me-2"></i>Data Management
                    </h5>
                    <p>At the top of the dashboard, you'll find:</p>
                    <ul>
                      <li>
                        <strong>Active Spreadsheet Indicator</strong> - Shows
                        your current data source
                      </li>
                      <li>
                        <strong>Open in Sheets Button</strong> - Opens your
                        source Google Sheet directly
                      </li>
                      <li>
                        <strong>Refresh All Data Button</strong> - Updates all
                        panels with the latest data
                      </li>
                    </ul>
                    <div class="alert alert-info mt-2">
                      <i class="bi bi-lightbulb me-2"></i>
                      <strong>Tip:</strong> Use the Refresh button whenever
                      you've made changes to the source spreadsheet to ensure
                      you're viewing the most current data.
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="card border-0 shadow-sm mb-3">
              <div class="card-body">
                <h5 class="card-title">
                  <i class="bi bi-palette me-2"></i>Dark Mode
                </h5>
                <p>
                  The dashboard includes a comprehensive dark mode that can be
                  toggled from the sidebar. Dark mode benefits include:
                </p>
                <div class="row">
                  <div class="col-md-6">
                    <ul>
                      <li>Reduced eye strain during extended use</li>
                      <li>Lower battery consumption on mobile devices</li>
                      <li>Better readability in low-light environments</li>
                    </ul>
                  </div>
                  <div class="col-md-6">
                    <div class="alert alert-secondary">
                      <i class="bi bi-lightbulb me-2"></i>
                      <strong>Tip:</strong> Your dark mode preference is
                      remembered between sessions, so you only need to set it
                      once.
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Managing Incidents -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingIncidents">
          <button
            class="accordion-button collapsed"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#collapseIncidents"
            aria-expanded="false"
            aria-controls="collapseIncidents"
          >
            <span id="help-incidents"></span>
            <i class="bi bi-ticket-perforated me-2 text-danger"></i>3. Managing
            Incidents
          </button>
        </h2>
        <div
          id="collapseIncidents"
          class="accordion-collapse collapse"
          aria-labelledby="headingIncidents"
          data-bs-parent="#helpAccordion"
        >
          <div class="accordion-body">
            <div class="card card-body bg-light help-card mb-3">
              <h5>
                <i class="bi bi-ticket-detailed me-2"></i>Incident Management
                System
              </h5>
              <p>
                The incident management system allows you to track and manage
                all submarine cable outages and incidents. Each incident is
                represented as a ticket that contains detailed information about
                the event, including affected systems, duration, and reason for
                outage (RFO).
              </p>
            </div>

            <h5 class="mb-3">
              <i class="bi bi-card-list me-2"></i>Working with the Ticket List
            </h5>
            <div class="row g-3 mb-3">
              <div class="col-lg-7">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <h6 class="card-title">Viewing and Selecting Tickets</h6>
                    <ul>
                      <li>
                        <strong>Browse Tickets</strong> - Scroll through the
                        paginated list
                      </li>
                      <li>
                        <strong>Search</strong> - Use the search box to filter
                        by any text within tickets
                      </li>
                      <li>
                        <strong>Single Select</strong> - Click once on any
                        ticket to select it
                      </li>
                      <li>
                        <strong>Multi-Select</strong> - Use Ctrl+Click or
                        Shift+Click for multiple selection
                      </li>
                      <li>
                        <strong>View Details</strong> - Double-click a ticket to
                        open its detailed view
                      </li>
                    </ul>
                    <h6 class="mt-3">Selection Keyboard Shortcuts:</h6>
                    <ul>
                      <li>
                        <kbd>Ctrl</kbd> + Click: Toggle selection of individual
                        tickets
                      </li>
                      <li>
                        <kbd>Shift</kbd> + Click: Select a range of tickets
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="col-lg-5">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <h6 class="card-title">Ticket List Toolbar</h6>
                    <div class="d-flex flex-column gap-2">
                      <div class="d-flex align-items-center">
                        <span class="badge bg-success me-2"
                          ><i class="bi bi-plus-lg"></i
                        ></span>
                        <span
                          ><strong>Add Ticket</strong> - Create a new incident
                          ticket</span
                        >
                      </div>
                      <div class="d-flex align-items-center">
                        <span class="badge bg-danger me-2"
                          ><i class="bi bi-trash"></i
                        ></span>
                        <span
                          ><strong>Delete Ticket</strong> - Remove selected
                          ticket(s)</span
                        >
                      </div>
                      <div class="d-flex align-items-center">
                        <span class="badge bg-secondary me-2"
                          ><i class="bi bi-search"></i
                        ></span>
                        <span
                          ><strong>Search</strong> - Filter tickets by
                          text</span
                        >
                      </div>
                      <div class="d-flex align-items-center">
                        <span class="badge bg-secondary me-2"
                          ><i class="bi bi-arrow-clockwise"></i
                        ></span>
                        <span
                          ><strong>Reset</strong> - Clear search and show all
                          tickets</span
                        >
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <h5 class="mb-3">
              <i class="bi bi-pencil-square me-2"></i>Ticket Details & Editing
            </h5>
            <div class="row g-3">
              <div class="col-lg-6">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <h6 class="card-title">Ticket Detail View</h6>
                    <p>
                      When you double-click a ticket, the details modal opens
                      showing:
                    </p>
                    <ul>
                      <li>All entries associated with this ticket ID</li>
                      <li>
                        Complete information for each entry including dates,
                        duration, and RFO
                      </li>
                      <li>
                        Options to add, edit, or delete individual entries
                      </li>
                    </ul>
                    <div class="alert alert-info">
                      <i class="bi bi-info-circle me-2"></i>
                      <strong>Note:</strong> A single ticket can have multiple
                      entries if the same incident affects different segments or
                      has multiple RFOs.
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-lg-6">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <h6 class="card-title">Adding & Editing Entries</h6>
                    <p>
                      When adding or editing entries, note these key fields:
                    </p>
                    <ul>
                      <li>
                        <strong>Start Date/Time</strong> - When the incident
                        began
                      </li>
                      <li>
                        <strong>End Date/Time</strong> - When service was
                        restored
                      </li>
                      <li>
                        <strong>Cable System</strong> - The affected submarine
                        cable
                      </li>
                      <li>
                        <strong>Affected Segment</strong> - Specific segment
                        impacted
                      </li>
                      <li><strong>RFO</strong> - Reason For Outage</li>
                    </ul>
                    <div class="alert alert-warning">
                      <i class="bi bi-exclamation-triangle me-2"></i>
                      <strong>Important:</strong> Duration, Month, and Year are
                      calculated automatically based on the start date/time.
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="card border-0 shadow-sm mb-3">
              <div class="card-body">
                <h5 class="card-title">
                  <i class="bi bi-download me-2"></i>Exporting Major Incidents
                  Data
                </h5>
                <p>
                  You can export the Major Incidents table in
                  <strong>CSV</strong> or <strong>PDF</strong> format for
                  reporting or further analysis. The export feature supports the
                  following options:
                </p>
                <ul>
                  <li>
                    <strong>Include Headers</strong> - Include column headers in
                    the export
                  </li>
                  <li>
                    <strong>Search Filter</strong> - Export only rows matching
                    your search
                  </li>
                  <li>
                    <strong>Custom Title & Filename</strong> - Set a custom
                    report title and filename
                  </li>
                  <li>
                    <strong>Include Export Date</strong> - Add the export date
                    to your report
                  </li>
                </ul>
                <h6 class="mt-3">How to Export:</h6>
                <ol>
                  <li>
                    Click the <strong>Export</strong> button in the Major
                    Incidents panel.
                  </li>
                  <li>Choose your desired export format (CSV or PDF).</li>
                  <li>
                    Select which options to include (headers, search filter,
                    etc.).
                  </li>
                  <li>Click <strong>Export</strong> to download your file.</li>
                </ol>
                <div class="alert alert-info mt-2">
                  <i class="bi bi-info-circle me-2"></i>
                  <strong>Note:</strong> Exported files are generated instantly
                  in your browser and do not require any additional permissions.
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Network Availability -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingNetwork">
          <button
            class="accordion-button collapsed"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#collapseNetwork"
            aria-expanded="false"
            aria-controls="collapseNetwork"
          >
            <span id="help-network"></span>
            <i class="bi bi-graph-up me-2 text-primary"></i>4. Network
            Availability
          </button>
        </h2>
        <div
          id="collapseNetwork"
          class="accordion-collapse collapse"
          aria-labelledby="headingNetwork"
          data-bs-parent="#helpAccordion"
        >
          <div class="accordion-body">
            <div class="card card-body bg-light help-card mb-3">
              <h5>
                <i class="bi bi-calendar-check me-2"></i>Network Availability
                Monitor
              </h5>
              <p>
                The Network Availability section provides a comprehensive
                month-by-month view of uptime percentages for each cable system
                and segment. This visualization helps identify patterns,
                recurring issues, and overall reliability trends.
              </p>
            </div>

            <div class="row g-3 mb-3">
              <div class="col-lg-7">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <h5 class="card-title">
                      <i class="bi bi-table me-2"></i>Understanding the
                      Availability Table
                    </h5>
                    <p>
                      The availability table displays monthly uptime percentages
                      with color-coding:
                    </p>
                    <ul class="list-group">
                      <li class="list-group-item d-flex align-items-center">
                        <span class="badge na-darkblue me-2" style="width: 30px"
                          >&nbsp;</span
                        >
                        <strong>Dark Blue (≥90%):</strong> Excellent
                        availability - minimal or no disruption
                      </li>
                      <li class="list-group-item d-flex align-items-center">
                        <span
                          class="badge na-lightgreen me-2"
                          style="width: 30px"
                          >&nbsp;</span
                        >
                        <strong>Light Green (70-89.9%):</strong> Good
                        availability - minor disruption
                      </li>
                      <li class="list-group-item d-flex align-items-center">
                        <span class="badge na-yellow me-2" style="width: 30px"
                          >&nbsp;</span
                        >
                        <strong>Yellow (40-69.9%):</strong> Moderate
                        availability - significant disruption
                      </li>
                      <li class="list-group-item d-flex align-items-center">
                        <span class="badge na-orange me-2" style="width: 30px"
                          >&nbsp;</span
                        >
                        <strong>Orange (20-39.9%):</strong> Poor availability -
                        major disruption
                      </li>
                      <li class="list-group-item d-flex align-items-center">
                        <span class="badge na-red me-2" style="width: 30px"
                          >&nbsp;</span
                        >
                        <strong>Red (<20%):</strong> Critical availability -
                        severe disruption
                      </li>
                    </ul>
                    <div class="alert alert-info mt-3">
                      <i class="bi bi-info-circle me-2"></i>
                      <strong>Note:</strong> Availability is calculated as the
                      percentage of time the cable system was operational during
                      each month.
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-lg-5">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <h5 class="card-title">
                      <i class="bi bi-sliders me-2"></i>Using the Controls
                    </h5>
                    <p>You can customize the view using these controls:</p>
                    <ul>
                      <li>
                        Select a <strong>Cable System</strong> from the dropdown
                        to focus on a specific cable
                      </li>
                      <li>
                        Choose an <strong>Affected Segment</strong> to view
                        availability for that specific segment
                      </li>
                      <li>
                        Use the <strong>Years per page</strong> control to
                        adjust how many years are displayed at once
                      </li>
                      <li>
                        Navigate between years using the
                        <strong>pagination controls</strong> below the table
                      </li>
                      <li>
                        Jump to a specific page using the
                        <strong>page jump</strong> control
                      </li>
                    </ul>
                    <div class="alert alert-warning mt-3">
                      <i class="bi bi-exclamation-triangle me-2"></i>
                      <strong>Important:</strong> Data is automatically
                      refreshed when changing cable system or segment selection.
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="card border-0 shadow-sm mb-4">
              <div class="card-body">
                <h5 class="card-title">
                  <i class="bi bi-calculator me-2"></i>How Network Availability
                  is Calculated
                </h5>
                <p>
                  The system uses a sophisticated algorithm that properly
                  handles overlapping downtime incidents:
                </p>

                <div class="alert alert-primary">
                  <strong>Network Availability Formula:</strong><br />
                  <div class="text-center my-2">
                    <span style="font-size: 1.2rem"
                      >Availability = (Total Time - Downtime) / ( Total Time) ×
                      100</span
                    >
                  </div>
                </div>

                <div class="row mt-3">
                  <div class="col-md-6">
                    <h6 class="fw-bold">Key Components:</h6>
                    <ul>
                      <li>
                        <strong>Total Time</strong>: Total seconds in the month
                        (days in month × 24 hours × 60 minutes × 60 seconds)
                      </li>
                      <li>
                        <strong>Downtime</strong>: Total seconds the system was
                        down, with overlapping incidents properly merged
                      </li>
                    </ul>

                    <h6 class="fw-bold mt-3">
                      Overlapping Downtime Algorithm:
                    </h6>
                    <ol>
                      <li>Sort all downtime intervals by start time</li>
                      <li>
                        Merge overlapping intervals into continuous periods
                      </li>
                      <li>
                        Calculate total downtime based on merged intervals
                      </li>
                    </ol>
                  </div>
                  <div class="col-md-6">
                    <div class="card bg-light">
                      <div class="card-body">
                        <h6 class="card-title">
                          <i class="bi bi-lightbulb me-2"></i>Example
                          Calculation
                        </h6>
                        <p>For January (31 days), if a cable system has:</p>
                        <ul class="mb-2">
                          <li>
                            Incident 1: Down from Jan 10, 1:00 PM to Jan 10,
                            5:00 PM (4 hours)
                          </li>
                          <li>
                            Incident 2: Down from Jan 10, 3:00 PM to Jan 10,
                            7:00 PM (4 hours)
                          </li>
                        </ul>
                        <p>
                          <strong>Traditional method (incorrect):</strong> 4 + 4
                          = 8 hours downtime
                        </p>
                        <p>
                          <strong>Merged method (correct):</strong> 1:00 PM to
                          7:00 PM = 6 hours downtime
                        </p>
                        <hr />
                        <p class="mb-1">
                          <strong>Total time:</strong> 2,678,400 seconds (31
                          days)
                        </p>
                        <p class="mb-1">
                          <strong>Downtime:</strong> 21,600 seconds (6 hours)
                        </p>
                        <p class="mb-1">
                          <strong>Availability:</strong> ((2,678,400 - 21,600) /
                          2,678,400) × 100 = 99.19%
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="card border-0 shadow-sm mb-3">
              <div class="card-body">
                <h5 class="card-title">
                  <i class="bi bi-download me-2"></i>Exporting Network
                  Availability Data
                </h5>
                <p>
                  You can export the Network Availability table in
                  <strong>CSV</strong> or <strong>PDF</strong> format for
                  reporting or further analysis. The export feature supports the
                  following options:
                </p>
                <ul>
                  <li>
                    <strong>Cable System & Segment Filters</strong> - Export
                    data for all or selected cable systems and segments
                  </li>
                  <li>
                    <strong>Year Range</strong> - Choose which years to include
                    in the export
                  </li>
                  <li>
                    <strong>Month Headers</strong> - Include or exclude month
                    columns
                  </li>
                  <li>
                    <strong>Color Coding</strong> - Enable color highlights in
                    PDF exports
                  </li>
                  <li>
                    <strong>Yearly Averages</strong> - Add average availability
                    per year
                  </li>
                  <li>
                    <strong>Custom Title & Filename</strong> - Set a custom
                    report title and filename
                  </li>
                  <li>
                    <strong>Include Export Date</strong> - Add the export date
                    to your report
                  </li>
                </ul>
                <h6 class="mt-3">How to Export:</h6>
                <ol>
                  <li>
                    Click the <strong>Export</strong> button in the Network
                    Availability panel.
                  </li>
                  <li>Choose your desired export format (CSV or PDF).</li>
                  <li>
                    Select filters and options as needed (Cable System, Segment,
                    Years, etc.).
                  </li>
                  <li>Click <strong>Export</strong> to download your file.</li>
                </ol>
                <div class="alert alert-info mt-2">
                  <i class="bi bi-info-circle me-2"></i>
                  <strong>Note:</strong> Exported files are generated instantly
                  in your browser and do not require any additional permissions.
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Outage Summary -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingOutage">
          <button
            class="accordion-button collapsed"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#collapseOutage"
            aria-expanded="false"
            aria-controls="collapseOutage"
          >
            <span id="help-outage"></span>
            <i class="bi bi-bar-chart me-2 text-warning"></i>5. Outage Summary
          </button>
        </h2>
        <div
          id="collapseOutage"
          class="accordion-collapse collapse"
          aria-labelledby="headingOutage"
          data-bs-parent="#helpAccordion"
        >
          <div class="accordion-body">
            <div class="card card-body bg-light help-card mb-3">
              <h5>
                <i class="bi bi-clipboard-data me-2"></i>Outage Summary Analysis
              </h5>
              <p>
                The Outage Summary provides a cross-tabulated view of outage
                incidents, grouping them by
                <strong>Reason For Outage (RFO)</strong> or
                <strong>Segment</strong> and Cable System. You can now switch
                between grouping by RFO or by Segment using the
                <strong>Group by</strong> dropdown above the table. This helps
                identify which causes or segments are most common for each cable
                system.
              </p>
            </div>

            <div class="row g-3 mb-3">
              <div class="col-lg-7">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <h5 class="card-title">
                      <i class="bi bi-table me-2"></i>Understanding the Summary
                      Table
                    </h5>
                    <p>
                      The summary table presents data in the following format:
                    </p>
                    <ul>
                      <li>
                        <strong>Rows</strong> - Each row represents a specific
                        RFO type or Segment, depending on the selected grouping
                      </li>
                      <li>
                        <strong>Columns</strong> - Each column represents a
                        cable system
                      </li>
                      <li>
                        <strong>Cell Values</strong> - The count of incidents
                        for that RFO/Segment and Cable System combination
                      </li>
                    </ul>
                    <p>This cross-tabulation makes it easy to identify:</p>
                    <ul>
                      <li>
                        The most common causes or segments of outages overall
                      </li>
                      <li>
                        Which cable systems are most prone to specific types of
                        failures or affected segments
                      </li>
                      <li>
                        Distribution patterns of outage causes or segments
                        across your network
                      </li>
                    </ul>
                    <div class="alert alert-info mt-2">
                      <i class="bi bi-info-circle me-2"></i>
                      <strong>Note:</strong> A value of zero indicates no
                      outages of that type have occurred on that cable system.
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-lg-5">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <h5 class="card-title">
                      <i class="bi bi-search me-2"></i>Filtering, Grouping, and
                      Navigation
                    </h5>
                    <p>You can focus your analysis with these controls:</p>
                    <ul>
                      <li>
                        <strong>Search</strong> - Filter RFOs or Segments by
                        keyword (e.g., "fiber", "power")
                      </li>
                      <li>
                        <strong>Group by</strong> - Switch between grouping by
                        RFO or by Segment using the dropdown
                      </li>
                      <li>
                        <strong>Reset</strong> - Clear search and show all
                        categories
                      </li>
                      <li>
                        <strong>Items per Page</strong> - Adjust how many
                        categories are shown at once
                      </li>
                      <li>
                        <strong>Page Navigation</strong> - Browse through
                        multiple pages
                      </li>
                      <li>
                        <strong>Page Jump</strong> - Go directly to a specific
                        page
                      </li>
                    </ul>
                    <div class="alert alert-secondary mt-3">
                      <i class="bi bi-lightbulb me-2"></i>
                      <strong>Tip:</strong> Use specific search terms like
                      "cut", "repair", or "maintenance" to focus on particular
                      categories of outages.
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="card border-0 shadow-sm mb-3">
              <div class="card-body">
                <h5 class="card-title">
                  <i class="bi bi-download me-2"></i>Exporting Outage Summary
                  Data
                </h5>
                <p>
                  You can export the Outage Summary table in
                  <strong>CSV</strong> or <strong>PDF</strong> format for
                  reporting or further analysis. The export feature supports the
                  following options:
                </p>
                <ul>
                  <li>
                    <strong>Include RFO</strong> - Include the RFO column in the
                    export
                  </li>
                  <li>
                    <strong>Include Segment</strong> - Include the Segment
                    column in the export
                  </li>
                  <li>
                    <strong>Include Cable Systems</strong> - Include all cable
                    system columns
                  </li>
                  <li>
                    <strong>Include Row Totals</strong> - Add a total column for
                    each row
                  </li>
                  <li>
                    <strong>Group by</strong> - Choose to export by RFO, by
                    Segment, or both (dual-table export)
                  </li>
                  <li>
                    <strong>Search Filter</strong> - Export only rows matching
                    your search
                  </li>
                  <li>
                    <strong>Custom Title & Filename</strong> - Set a custom
                    report title and filename
                  </li>
                  <li>
                    <strong>Include Export Date</strong> - Add the export date
                    to your report
                  </li>
                </ul>
                <h6 class="mt-3">How to Export:</h6>
                <ol>
                  <li>
                    Click the <strong>Export</strong> button in the Outage
                    Summary panel.
                  </li>
                  <li>Choose your desired export format (CSV or PDF).</li>
                  <li>
                    Select which columns and options to include (RFO, Segment,
                    Cable Systems, Totals, etc.).
                  </li>
                  <li>
                    Optionally, filter the data using the search box or change
                    the grouping.
                  </li>
                  <li>Click <strong>Export</strong> to download your file.</li>
                  <li>
                    If you select both RFO and Segment, a dual-table export will
                    be generated (one for each grouping).
                  </li>
                </ol>
                <div class="alert alert-info mt-2">
                  <i class="bi bi-info-circle me-2"></i>
                  <strong>Note:</strong> Exported files are generated instantly
                  in your browser and do not require any additional permissions.
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Configuration -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingSettings">
          <button
            class="accordion-button collapsed"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#collapseSettings"
            aria-expanded="false"
            aria-controls="collapseSettings"
          >
            <span id="help-settings"></span>
            <i class="bi bi-gear me-2 text-secondary"></i>6. Configuration
            Settings
          </button>
        </h2>
        <div
          id="collapseSettings"
          class="accordion-collapse collapse"
          aria-labelledby="headingSettings"
          data-bs-parent="#helpAccordion"
        >
          <div class="accordion-body">
            <div class="card card-body bg-light help-card mb-3">
              <h5>
                <i class="bi bi-wrench-adjustable me-2"></i>Data Source
                Configuration
              </h5>
              <p>
                The Settings section allows you to configure the data source for
                the application by connecting to a Google Sheet that contains
                your cable system data.
              </p>
            </div>

            <div class="row g-3 mb-3">
              <div class="col-md-7">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <h5 class="card-title">
                      <i class="bi bi-file-spreadsheet me-2"></i>Google Sheet
                      Requirements
                    </h5>
                    <p>
                      Your Google Sheet must include a sheet named
                      <code>MAJOR INCIDENTS_UPDATED</code> with these columns:
                    </p>
                    <ul>
                      <li>
                        <strong>Ticket</strong> - Unique identifier for each
                        incident
                      </li>
                      <li>
                        <strong>Start Date</strong> - When the outage began
                      </li>
                      <li>
                        <strong>End Date</strong> - When service was restored
                      </li>
                      <li>
                        <strong>Duration</strong> - Calculated field showing
                        outage duration
                      </li>
                      <li>
                        <strong>Cable System</strong> - The affected submarine
                        cable
                      </li>
                      <li>
                        <strong>Affected Segment</strong> - Specific segment
                        impacted
                      </li>
                      <li><strong>RFO</strong> - Reason For Outage</li>
                      <li>
                        <strong>Month</strong> - Calculated field showing month
                        of outage
                      </li>
                      <li>
                        <strong>Year</strong> - Calculated field showing year of
                        outage
                      </li>
                    </ul>
                    <div class="alert alert-warning mt-3">
                      <i class="bi bi-exclamation-triangle me-2"></i>
                      <strong>Important:</strong> For Cable System and Affected
                      Segment columns, use dropdown data validation in your
                      Google Sheet to ensure consistent values.
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-5">
                <div class="card border-0 shadow-sm mb-3">
                  <div class="card-body">
                    <h5 class="card-title">
                      <i class="bi bi-link-45deg me-2"></i>Connecting Your Sheet
                    </h5>
                    <ol>
                      <li>
                        Go to the <strong>Settings</strong> section via the
                        sidebar
                      </li>
                      <li>
                        Enter your Google Sheet URL or ID in the input field
                      </li>
                      <li>Click <strong>Save & Apply</strong></li>
                      <li>Grant permissions when prompted</li>
                      <li>The application will refresh to load your data</li>
                    </ol>
                  </div>
                </div>

                <div class="card border-0 shadow-sm">
                  <div class="card-body">
                    <h5 class="card-title">
                      <i class="bi bi-shield-lock me-2"></i>Permissions
                    </h5>
                    <p>
                      When setting up your data source, the application will
                      request:
                    </p>
                    <ul>
                      <li>Read access to your Google Sheet</li>
                      <li>Permission to run as your account</li>
                    </ul>
                    <p>
                      These permissions are necessary to retrieve and update
                      data in your sheet.
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <div class="card border-0 shadow-sm">
              <div class="card-body">
                <h5 class="card-title">
                  <i class="bi bi-layers me-2"></i>Advanced Configuration
                </h5>
                <div class="row">
                  <div class="col-md-6">
                    <h6>Recommended Sheet Structure</h6>
                    <ul>
                      <li>
                        Use consistent naming conventions in your spreadsheet
                      </li>
                      <li>Set up data validation for categorical fields</li>
                      <li>Use date formatting for timestamp fields</li>
                      <li>
                        Consider adding conditional formatting to highlight
                        issues
                      </li>
                    </ul>
                  </div>
                  <div class="col-md-6">
                    <div class="alert alert-info">
                      <i class="bi bi-info-circle me-2"></i>
                      <strong>Note:</strong> Multiple users can access the same
                      dashboard simultaneously by connecting to the same Google
                      Sheet. This enables collaborative monitoring and
                      management.
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Troubleshooting -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingTroubleshooting">
          <button
            class="accordion-button collapsed"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#collapseTroubleshooting"
            aria-expanded="false"
            aria-controls="collapseTroubleshooting"
          >
            <span id="help-troubleshooting"></span>
            <i class="bi bi-tools me-2 text-info"></i>7. Troubleshooting & FAQ
          </button>
        </h2>
        <div
          id="collapseTroubleshooting"
          class="accordion-collapse collapse"
          aria-labelledby="headingTroubleshooting"
          data-bs-parent="#helpAccordion"
        >
          <div class="accordion-body">
            <div class="card card-body bg-light help-card mb-3">
              <h5>
                <i class="bi bi-question-circle me-2"></i>Common Issues and
                Solutions
              </h5>
              <p>
                This section addresses frequently encountered problems and
                provides step-by-step solutions to help you quickly resolve
                issues and get the most out of the ISCS Dashboard.
              </p>
            </div>

            <div class="accordion" id="faqAccordion">
              <!-- Data Loading Issues -->
              <div class="accordion-item">
                <h2 class="accordion-header" id="headingDataIssues">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#collapseDataIssues"
                  >
                    <i class="bi bi-database-exclamation me-2 text-danger"></i
                    >Data Loading Issues
                  </button>
                </h2>
                <div
                  id="collapseDataIssues"
                  class="accordion-collapse collapse"
                  data-bs-parent="#faqAccordion"
                >
                  <div class="accordion-body">
                    <div class="d-flex align-items-start mb-3">
                      <div class="flex-shrink-0 text-danger me-3">
                        <i class="bi bi-exclamation-triangle-fill fs-4"></i>
                      </div>
                      <div>
                        <h6>"No Sheet ID set" or "No data available" error</h6>
                        <ol>
                          <li>Go to the Settings section</li>
                          <li>
                            Verify that a Google Sheet ID has been entered
                          </li>
                          <li>
                            Make sure the Google Sheet exists and is accessible
                            to your account
                          </li>
                          <li>
                            Check that the sheet contains a tab named "MAJOR
                            INCIDENTS_UPDATED"
                          </li>
                          <li>
                            Try the "Refresh All Data" button on the dashboard
                          </li>
                        </ol>
                      </div>
                    </div>

                    <div class="d-flex align-items-start mb-3">
                      <div class="flex-shrink-0 text-danger me-3">
                        <i class="bi bi-exclamation-triangle-fill fs-4"></i>
                      </div>
                      <div>
                        <h6>Data not refreshing or outdated</h6>
                        <ol>
                          <li>
                            Click the "Refresh All Data" button at the top of
                            the dashboard
                          </li>
                          <li>
                            Check if your browser has cached old data:
                            <ul>
                              <li>
                                Press <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd
                                  >R</kbd
                                >
                                (Windows/Linux) or
                                <kbd>Cmd</kbd>+<kbd>Shift</kbd>+<kbd>R</kbd>
                                (Mac) to force a complete refresh
                              </li>
                            </ul>
                          </li>
                          <li>
                            Verify that changes have been saved in your source
                            Google Sheet
                          </li>
                          <li>
                            Check that you're using the correct Sheet ID in
                            Settings
                          </li>
                        </ol>
                      </div>
                    </div>

                    <div class="d-flex align-items-start">
                      <div class="flex-shrink-0 text-danger me-3">
                        <i class="bi bi-exclamation-triangle-fill fs-4"></i>
                      </div>
                      <div>
                        <h6>Permission errors when accessing data</h6>
                        <ol>
                          <li>
                            Make sure you are logged into the correct Google
                            account
                          </li>
                          <li>
                            Verify that your account has access to the specified
                            Google Sheet
                          </li>
                          <li>
                            Try re-saving the Sheet ID in Settings to trigger a
                            fresh authentication flow
                          </li>
                          <li>
                            If accessing a shared sheet, ask the owner to check
                            sharing permissions
                          </li>
                        </ol>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- UI and Display Issues -->
              <div class="accordion-item">
                <h2 class="accordion-header" id="headingUIIssues">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#collapseUIIssues"
                  >
                    <i class="bi bi-display me-2 text-warning"></i>UI and
                    Display Issues
                  </button>
                </h2>
                <div
                  id="collapseUIIssues"
                  class="accordion-collapse collapse"
                  data-bs-parent="#faqAccordion"
                >
                  <div class="accordion-body">
                    <div class="d-flex align-items-start mb-3">
                      <div class="flex-shrink-0 text-warning me-3">
                        <i class="bi bi-exclamation-triangle-fill fs-4"></i>
                      </div>
                      <div>
                        <h6>Tables or charts not rendering correctly</h6>
                        <ol>
                          <li>Try resizing your browser window</li>
                          <li>
                            Check if your browser zoom level is set to 100%
                          </li>
                          <li>Try a different browser (Chrome recommended)</li>
                          <li>
                            Disable browser extensions that might interfere with
                            rendering
                          </li>
                          <li>
                            Check console for JavaScript errors (F12 > Console)
                          </li>
                        </ol>
                      </div>
                    </div>

                    <div class="d-flex align-items-start mb-3">
                      <div class="flex-shrink-0 text-warning me-3">
                        <i class="bi bi-exclamation-triangle-fill fs-4"></i>
                      </div>
                      <div>
                        <h6>Dark mode display problems</h6>
                        <ol>
                          <li>Toggle dark mode off and on again</li>
                          <li>Try refreshing the page</li>
                          <li>Clear browser cache and cookies</li>
                          <li>
                            Try disabling any browser extensions that modify
                            page styling
                          </li>
                        </ol>
                      </div>
                    </div>

                    <div class="d-flex align-items-start">
                      <div class="flex-shrink-0 text-warning me-3">
                        <i class="bi bi-exclamation-triangle-fill fs-4"></i>
                      </div>
                      <div>
                        <h6>Mobile device display issues</h6>
                        <ol>
                          <li>
                            Rotate device to landscape orientation for better
                            viewing
                          </li>
                          <li>
                            Use the "Request desktop site" option in your mobile
                            browser
                          </li>
                          <li>
                            For small screens, use horizontal scroll on tables
                          </li>
                          <li>
                            Consider using a tablet or desktop for complex data
                            manipulation
                          </li>
                        </ol>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Feature-Specific Questions -->
              <div class="accordion-item">
                <h2 class="accordion-header" id="headingFeatureQuestions">
                  <button
                    class="accordion-button collapsed"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#collapseFeatureQuestions"
                  >
                    <i class="bi bi-chat-right-text me-2 text-success"></i
                    >Feature-Specific Questions
                  </button>
                </h2>
                <div
                  id="collapseFeatureQuestions"
                  class="accordion-collapse collapse"
                  data-bs-parent="#faqAccordion"
                >
                  <div class="accordion-body">
                    <h6 class="fw-bold">Ticket Management</h6>
                    <div class="mb-3">
                      <div class="d-flex mb-2">
                        <div class="fw-bold me-2">Q:</div>
                        <div>Can I edit multiple tickets at once?</div>
                      </div>
                      <div class="d-flex ms-3">
                        <div class="fw-bold me-2">A:</div>
                        <div>
                          No, bulk editing is not currently supported. You need
                          to edit tickets individually. However, you can delete
                          multiple tickets at once by selecting them and using
                          the Delete button.
                        </div>
                      </div>
                    </div>

                    <div class="mb-3">
                      <div class="d-flex mb-2">
                        <div class="fw-bold me-2">Q:</div>
                        <div>Can I export ticket data from the dashboard?</div>
                      </div>
                      <div class="d-flex ms-3">
                        <div class="fw-bold me-2">A:</div>
                        <div>
                          The dashboard doesn't have a direct export function,
                          but you can access all your data directly in the
                          connected Google Sheet. Use the "Open in Sheets"
                          button at the top of the dashboard.
                        </div>
                      </div>
                    </div>

                    <h6 class="fw-bold mt-4">Network Availability</h6>
                    <div class="mb-3">
                      <div class="d-flex mb-2">
                        <div class="fw-bold me-2">Q:</div>
                        <div>How is availability percentage calculated?</div>
                      </div>
                      <div class="d-flex ms-3">
                        <div class="fw-bold me-2">A:</div>
                        <div>
                          Availability is calculated as: [(Total minutes in
                          month - Downtime minutes) / Total minutes in month] ×
                          100%. This gives the percentage of time the cable
                          system was operational.
                        </div>
                      </div>
                    </div>

                    <div class="mb-3">
                      <div class="d-flex mb-2">
                        <div class="fw-bold me-2">Q:</div>
                        <div>
                          Why are some months showing 100% availability when
                          there were known issues?
                        </div>
                      </div>
                      <div class="d-flex ms-3">
                        <div class="fw-bold me-2">A:</div>
                        <div>
                          Check that all incidents are properly recorded in your
                          spreadsheet with accurate start and end dates. Also
                          verify that the correct cable system and segment are
                          selected in the filters.
                        </div>
                      </div>
                    </div>

                    <h6 class="fw-bold mt-4">Data Management</h6>
                    <div class="mb-3">
                      <div class="d-flex mb-2">
                        <div class="fw-bold me-2">Q:</div>
                        <div>
                          Can multiple users update the dashboard
                          simultaneously?
                        </div>
                      </div>
                      <div class="d-flex ms-3">
                        <div class="fw-bold me-2">A:</div>
                        <div>
                          Yes, multiple users can access and update data. Since
                          all data is stored in Google Sheets, updates are
                          synchronized based on Google's collaborative editing
                          features. Use "Refresh All Data" to see the latest
                          changes.
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="mt-4">
              <div class="card border-0 shadow-sm">
                <div class="card-body">
                  <h5 class="card-title mb-3">
                    <i class="bi bi-lightbulb me-2"></i>Quick Tips
                  </h5>
                  <div class="row g-3">
                    <div class="col-md-4">
                      <div class="border rounded p-3 h-100">
                        <h6>
                          <i class="bi bi-arrow-clockwise me-2 text-primary"></i
                          >Refresh Regularly
                        </h6>
                        <p class="mb-0 small">
                          Use the "Refresh All Data" button periodically to
                          ensure you're seeing the most current information,
                          especially in multi-user environments.
                        </p>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="border rounded p-3 h-100">
                        <h6>
                          <i class="bi bi-search me-2 text-primary"></i
                          >Effective Searching
                        </h6>
                        <p class="mb-0 small">
                          When searching, use specific keywords rather than
                          partial phrases for more accurate results. Search is
                          case-insensitive.
                        </p>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="border rounded p-3 h-100">
                        <h6>
                          <i class="bi bi-keyboard me-2 text-primary"></i
                          >Keyboard Shortcuts
                        </h6>
                        <p class="mb-0 small">
                          Use keyboard shortcuts like Ctrl+Click for
                          multi-select and Shift+Click for range selection in
                          ticket lists and tables.
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Support & Contact -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingSupport">
          <button
            class="accordion-button collapsed"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#collapseSupport"
            aria-expanded="false"
            aria-controls="collapseSupport"
          >
            <i class="bi bi-headset me-2 text-primary"></i>8. Support & Contact
          </button>
        </h2>
        <div
          id="collapseSupport"
          class="accordion-collapse collapse"
          aria-labelledby="headingSupport"
          data-bs-parent="#helpAccordion"
        >
          <div class="accordion-body">
            <div class="row g-3">
              <div class="col-md-6">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <h5 class="card-title">
                      <i class="bi bi-book me-2"></i>Documentation Resources
                    </h5>
                    <ul class="list-group list-group-flush">
                      <li class="list-group-item d-flex align-items-center">
                        <i class="bi bi-github me-3 fs-4"></i>
                        <div>
                          <strong
                            ><a
                              href="https://github.com/Azurenian/Globe-SCSOT"
                              target="_blank"
                              >GitHub Repository</a
                            ></strong
                          >
                          <div class="text-muted">
                            Source code and documentation
                          </div>
                        </div>
                      </li>
                      <li class="list-group-item d-flex align-items-center">
                        <i class="bi bi-journal-text me-3 fs-4"></i>
                        <div>
                          <strong
                            ><a
                              href="https://github.com/Azurenian/Globe-SCSOT/wiki"
                              target="_blank"
                              >GitHub Wiki</a
                            ></strong
                          >
                          <div class="text-muted">
                            Technical Documentation and Setup Guides
                          </div>
                        </div>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="card border-0 shadow-sm h-100">
                  <div class="card-body">
                    <h5 class="card-title">
                      <i class="bi bi-envelope me-2"></i>Contact Support
                    </h5>
                    <div class="mb-4">
                      <h6 class="fw-bold">Technical Support</h6>
                      <p>
                        <a
                          href="mailto:azure.erudition@gmail.com"
                          class="text-decoration-none"
                        >
                          <i class="bi bi-envelope-fill me-2"></i>
                          azure.erudition@gmail.com
                        </a>
                      </p>
                    </div>
                    <div>
                      <h6 class="fw-bold">Feedback & Bug Reports</h6>
                      <p>
                        <a
                          href="mailto:azure.erudition@gmail.com"
                          class="text-decoration-none"
                        >
                          <i class="bi bi-envelope-fill me-2"></i>
                          azure.erudition@gmail.com
                        </a>
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="text-center mt-4">
      <span class="text-muted small"
        >Last updated: June 02, 2025 | Version: scstov-dash_v2.fl</span
      >
    </div>
  </div>
</div>
<script>
  // Quick Access Nav: Open accordion and scroll to section
  document.querySelectorAll('.nav-link[href^="#help-"]').forEach((link) => {
    link.addEventListener("click", function (e) {
      e.preventDefault();
      const hash = this.getAttribute("href");
      // Map anchor to accordion collapse ID
      const sectionMap = {
        "#help-overview": "collapseOverview",
        "#help-dashboard": "collapseDashboard",
        "#help-incidents": "collapseIncidents",
        "#help-network": "collapseNetwork",
        "#help-outage": "collapseOutage",
        "#help-settings": "collapseSettings",
        "#help-troubleshooting": "collapseTroubleshooting",
      };
      // Collapse all sections
      Object.values(sectionMap).forEach((id) => {
        const el = document.getElementById(id);
        if (el && el.classList.contains("show")) {
          new bootstrap.Collapse(el, { toggle: false }).hide();
        }
      });
      // Open the selected section
      const collapseId = sectionMap[hash];
      const collapseEl = document.getElementById(collapseId);
      if (collapseEl) {
        new bootstrap.Collapse(collapseEl, { toggle: false }).show();
        // Scroll to the accordion header
        const header = collapseEl.previousElementSibling;
        if (header) {
          window.scrollTo({
            top: header.getBoundingClientRect().top + window.scrollY - 80,
            behavior: "smooth",
          });
        }
      }
    });
  });
</script>
